{#发表页#}
{% extends 'base/frame.html' %}
{% load static %}
{% block CustomCss %}
{#    <link rel="stylesheet" href="{% static "css/style.css" %}">#}
{% endblock %}

{% block content %}

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox ">
                <div class="ibox-title">
                    <h5>我的
                        <small></small>
                    </h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <form method="post" onsubmit="return false;">
                        <div class="form-group  row"><label class="col-sm-2 col-form-label">登录名</label>
                            <div class="col-md-4"><input name="username" value="{{ user.username }}" type="text" class="form-control"></div>
                        </div>
                        <div class="form-group  row"><label class="col-sm-2 col-form-label">姓</label>
                            <div class="col-md-4"><input name="first_name" value="{{ user.first_name }}" type="text" class="form-control"></div>
                        </div>
                        <div class="form-group  row"><label class="col-sm-2 col-form-label">名</label>
                            <div class="col-md-4"><input name="last_name" value="{{ user.last_name }}" type="text" class="form-control"></div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group  row"><label class="col-sm-2 col-form-label">手机号</label>
                            <div class="col-md-4"><input name="phoneNumber" value="{{ user.phoneNumber }}" type="tel" class="form-control"></div>
                        </div>
                        <div class="form-group  row"><label class="col-sm-2 col-form-label">邮箱</label>
                            <div class="col-md-4"><input name="email" value="{{ user.email }}" type="email" class="form-control"></div>
                        </div>
                        <div class="hr-line-dashed"></div>

                        <div class="form-group  row"><label class="col-sm-2 col-form-label">座右铭</label>
                            <div class="col-md-4"><input name="motto" value="{{ user.motto }}" type="text" class="form-control"></div>
                        </div>
                        <div class="hr-line-dashed"></div>

                        <div class="form-group row">
                            <div class="col-sm-4 col-sm-offset-2">
{#                                <button class="btn btn-white btn-sm" type="submit">Cancel</button>#}
                                <button class="btn btn-primary btn-sm" id="submit">更新信息</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block CustomJs %}
    <script>
        $('#submit').click(function () {
            console.log("in");
            let data = {};
            $("form input").each(function () {
                data[$(this).attr("name")] = $(this).val()
            });
            f(data)
        });

        f = function (data) {
            swal({
                title: "确认?",
                text: "确认修改",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "确认",
                cancelButtonText: "取消",
                closeOnConfirm: false
            }, function () {
                $.ajax({
                    url : '/author/author_info_update',
                    data: data,
                    type: 'POST',
                    headers:{"X-CSRFToken":$.cookie('csrftoken')},
                    success: function (res) {
                        res = JSON.parse(res);
                        if(res.code === 200){
                            swal.close()
                        }
                    }
                })
            });
        }
    </script>
{% endblock %}